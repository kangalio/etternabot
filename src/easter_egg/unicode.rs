const NORMAL_ALPHABET: &str = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
// Sourced from https://qaz.wtf/u/convert.cgi
const FUNKY_ALPHABETS: &[&str] = &[
    "â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“žâ“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©â’¶â’·â’¸â’¹â’ºâ’»â’¼â’½â’¾â’¿â“€â“â“‚â“ƒâ“„â“…â“†â“‡â“ˆâ“‰â“Šâ“‹â“Œâ“â“Žâ“",
    "ðŸ…ðŸ…‘ðŸ…’ðŸ…“ðŸ…”ðŸ…•ðŸ…–ðŸ…—ðŸ…˜ðŸ…™ðŸ…šðŸ…›ðŸ…œðŸ…ðŸ…žðŸ…ŸðŸ… ðŸ…¡ðŸ…¢ðŸ…£ðŸ…¤ðŸ…¥ðŸ…¦ðŸ…§ðŸ…¨ðŸ…©ðŸ…ðŸ…‘ðŸ…’ðŸ…“ðŸ…”ðŸ…•ðŸ…–ðŸ…—ðŸ…˜ðŸ…™ðŸ…šðŸ…›ðŸ…œðŸ…ðŸ…žðŸ…ŸðŸ… ðŸ…¡ðŸ…¢ðŸ…£ðŸ…¤ðŸ…¥ðŸ…¦ðŸ…§ðŸ…¨ðŸ…©",
    "ï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½Žï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½šï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼º",
    "ðšð›ðœððžðŸð ð¡ð¢ð£ð¤ð¥ð¦ð§ð¨ð©ðªð«ð¬ð­ð®ð¯ð°ð±ð²ð³ð€ðð‚ðƒð„ð…ð†ð‡ðˆð‰ðŠð‹ðŒððŽððð‘ð’ð“ð”ð•ð–ð—ð˜ð™",
    "ð–†ð–‡ð–ˆð–‰ð–Šð–‹ð–Œð–ð–Žð–ð–ð–‘ð–’ð–“ð–”ð–•ð––ð–—ð–˜ð–™ð–šð–›ð–œð–ð–žð–Ÿð•¬ð•­ð•®ð•¯ð•°ð•±ð•²ð•³ð•´ð•µð•¶ð•·ð•¸ð•¹ð•ºð•»ð•¼ð•½ð•¾ð•¿ð–€ð–ð–‚ð–ƒð–„ð–…",
    "ð’‚ð’ƒð’„ð’…ð’†ð’‡ð’ˆð’‰ð’Šð’‹ð’Œð’ð’Žð’ð’ð’‘ð’’ð’“ð’”ð’•ð’–ð’—ð’˜ð’™ð’šð’›ð‘¨ð‘©ð‘ªð‘«ð‘¬ð‘­ð‘®ð‘¯ð‘°ð‘±ð‘²ð‘³ð‘´ð‘µð‘¶ð‘·ð‘¸ð‘¹ð‘ºð‘»ð‘¼ð‘½ð‘¾ð‘¿ð’€ð’",
    "ð“ªð“«ð“¬ð“­ð“®ð“¯ð“°ð“±ð“²ð“³ð“´ð“µð“¶ð“·ð“¸ð“¹ð“ºð“»ð“¼ð“½ð“¾ð“¿ð”€ð”ð”‚ð”ƒð“ð“‘ð“’ð““ð“”ð“•ð“–ð“—ð“˜ð“™ð“šð“›ð“œð“ð“žð“Ÿð“ ð“¡ð“¢ð“£ð“¤ð“¥ð“¦ð“§ð“¨ð“©",
    "ð•’ð•“ð•”ð••ð•–ð•—ð•˜ð•™ð•šð•›ð•œð•ð•žð•Ÿð• ð•¡ð•¢ð•£ð•¤ð•¥ð•¦ð•§ð•¨ð•©ð•ªð•«ð”¸ð”¹â„‚ð”»ð”¼ð”½ð”¾â„ð•€ð•ð•‚ð•ƒð•„â„•ð•†â„™â„šâ„ð•Šð•‹ð•Œð•ð•Žð•ð•â„¤",
    "ðšŠðš‹ðšŒðšðšŽðšðšðš‘ðš’ðš“ðš”ðš•ðš–ðš—ðš˜ðš™ðššðš›ðšœðšðšžðšŸðš ðš¡ðš¢ðš£ð™°ð™±ð™²ð™³ð™´ð™µð™¶ð™·ð™¸ð™¹ð™ºð™»ð™¼ð™½ð™¾ð™¿ðš€ðšðš‚ðšƒðš„ðš…ðš†ðš‡ðšˆðš‰",
    "ð–ºð–»ð–¼ð–½ð–¾ð–¿ð—€ð—ð—‚ð—ƒð—„ð—…ð—†ð—‡ð—ˆð—‰ð—Šð—‹ð—Œð—ð—Žð—ð—ð—‘ð—’ð—“ð– ð–¡ð–¢ð–£ð–¤ð–¥ð–¦ð–§ð–¨ð–©ð–ªð–«ð–¬ð–­ð–®ð–¯ð–°ð–±ð–²ð–³ð–´ð–µð–¶ð–·ð–¸ð–¹",
    "ð—®ð—¯ð—°ð—±ð—²ð—³ð—´ð—µð—¶ð—·ð—¸ð—¹ð—ºð—»ð—¼ð—½ð—¾ð—¿ð˜€ð˜ð˜‚ð˜ƒð˜„ð˜…ð˜†ð˜‡ð—”ð—•ð—–ð——ð—˜ð—™ð—šð—›ð—œð—ð—žð—Ÿð— ð—¡ð—¢ð—£ð—¤ð—¥ð—¦ð—§ð—¨ð—©ð—ªð—«ð—¬ð—­",
    "ð™–ð™—ð™˜ð™™ð™šð™›ð™œð™ð™žð™Ÿð™ ð™¡ð™¢ð™£ð™¤ð™¥ð™¦ð™§ð™¨ð™©ð™ªð™«ð™¬ð™­ð™®ð™¯ð˜¼ð˜½ð˜¾ð˜¿ð™€ð™ð™‚ð™ƒð™„ð™…ð™†ð™‡ð™ˆð™‰ð™Šð™‹ð™Œð™ð™Žð™ð™ð™‘ð™’ð™“ð™”ð™•",
    "ð˜¢ð˜£ð˜¤ð˜¥ð˜¦ð˜§ð˜¨ð˜©ð˜ªð˜«ð˜¬ð˜­ð˜®ð˜¯ð˜°ð˜±ð˜²ð˜³ð˜´ð˜µð˜¶ð˜·ð˜¸ð˜¹ð˜ºð˜»ð˜ˆð˜‰ð˜Šð˜‹ð˜Œð˜ð˜Žð˜ð˜ð˜‘ð˜’ð˜“ð˜”ð˜•ð˜–ð˜—ð˜˜ð˜™ð˜šð˜›ð˜œð˜ð˜žð˜Ÿð˜ ð˜¡",
    "â’œâ’â’žâ’Ÿâ’ â’¡â’¢â’£â’¤â’¥â’¦â’§â’¨â’©â’ªâ’«â’¬â’­â’®â’¯â’°â’±â’²â’³â’´â’µâ’œâ’â’žâ’Ÿâ’ â’¡â’¢â’£â’¤â’¥â’¦â’§â’¨â’©â’ªâ’«â’¬â’­â’®â’¯â’°â’±â’²â’³â’´â’µ",
    "ðŸ‡¦ðŸ‡§ðŸ‡¨ðŸ‡©ðŸ‡ªðŸ‡«ðŸ‡¬ðŸ‡­ðŸ‡®ðŸ‡¯ðŸ‡°ðŸ‡±ðŸ‡²ðŸ‡³ðŸ‡´ðŸ‡µðŸ‡¶ðŸ‡·ðŸ‡¸ðŸ‡¹ðŸ‡ºðŸ‡»ðŸ‡¼ðŸ‡½ðŸ‡¾ðŸ‡¿ðŸ‡¦ðŸ‡§ðŸ‡¨ðŸ‡©ðŸ‡ªðŸ‡«ðŸ‡¬ðŸ‡­ðŸ‡®ðŸ‡¯ðŸ‡°ðŸ‡±ðŸ‡²ðŸ‡³ðŸ‡´ðŸ‡µðŸ‡¶ðŸ‡·ðŸ‡¸ðŸ‡¹ðŸ‡ºðŸ‡»ðŸ‡¼ðŸ‡½ðŸ‡¾ðŸ‡¿",
    "ðŸ„°ðŸ„±ðŸ„²ðŸ„³ðŸ„´ðŸ„µðŸ„¶ðŸ„·ðŸ„¸ðŸ„¹ðŸ„ºðŸ„»ðŸ„¼ðŸ„½ðŸ„¾ðŸ„¿ðŸ…€ðŸ…ðŸ…‚ðŸ…ƒðŸ…„ðŸ……ðŸ…†ðŸ…‡ðŸ…ˆðŸ…‰ðŸ„°ðŸ„±ðŸ„²ðŸ„³ðŸ„´ðŸ„µðŸ„¶ðŸ„·ðŸ„¸ðŸ„¹ðŸ„ºðŸ„»ðŸ„¼ðŸ„½ðŸ„¾ðŸ„¿ðŸ…€ðŸ…ðŸ…‚ðŸ…ƒðŸ…„ðŸ……ðŸ…†ðŸ…‡ðŸ…ˆðŸ…‰",
    "ðŸ…°ðŸ…±ðŸ…²ðŸ…³ðŸ…´ðŸ…µðŸ…¶ðŸ…·ðŸ…¸ðŸ…¹ðŸ…ºðŸ…»ðŸ…¼ðŸ…½ðŸ…¾ðŸ…¿ðŸ†€ðŸ†ðŸ†‚ðŸ†ƒðŸ†„ðŸ†…ðŸ††ðŸ†‡ðŸ†ˆðŸ†‰ðŸ…°ðŸ…±ðŸ…²ðŸ…³ðŸ…´ðŸ…µðŸ…¶ðŸ…·ðŸ…¸ðŸ…¹ðŸ…ºðŸ…»ðŸ…¼ðŸ…½ðŸ…¾ðŸ…¿ðŸ†€ðŸ†ðŸ†‚ðŸ†ƒðŸ†„ðŸ†…ðŸ††ðŸ†‡ðŸ†ˆðŸ†‰",
    "Ã¡bÄ‡dÃ©fÇµhÃ­já¸±Äºá¸¿Å„Å‘á¹•qÅ•Å›tÃºváºƒxÓ³ÅºÃBÄ†DÃ‰FÇ´HÃ­Já¸°Ä¹á¸¾ÅƒÅá¹”QÅ”Å›TÅ°Váº‚XÓ²Å¹",
    "ï¾‘ä¹ƒcdä¹‡ï½·gã‚“ï¾‰ï¾Œã‚ºï¾šï¾¶åˆ€oï½±qå°ºä¸‚ï½²uâˆšwï¾’ï¾˜ä¹™ï¾‘ä¹ƒcdä¹‡ï½·gã‚“ï¾‰ï¾Œã‚ºï¾šï¾¶åˆ€oï½±qå°ºä¸‚ï½²uâˆšwï¾’ï¾˜ä¹™",
    "à¸„à¹’ÆˆÉ—ï»‰à¤¿ï»­É¦Ù±ï»á›•É­à¹“à¸Ñ»ÏÛ¹É¼à¸£Õ‡àªªÛ·à¸à¸‹×¥Õ¹à¸„à¹’ÆˆÉ—ï»‰à¤¿ï»­É¦Ù±ï»á›•É­à¹“à¸Ñ»ÏÛ¹É¼à¸£Õ‡àªªÛ·à¸à¸‹×¥Õ¹",
    "Î±Ð²Â¢âˆ‚Ñ”Æ’ï»­Ð½Î¹× Ðºâ„“Ð¼Î·ÏƒÏÛ¹ÑÑ•Ñ‚Ï…Î½Ï‰Ï‡ÑƒÕ¹Î±Ð²Â¢âˆ‚Ñ”Æ’ï»­Ð½Î¹× Ðºâ„“Ð¼Î·ÏƒÏÛ¹ÑÑ•Ñ‚Ï…Î½Ï‰Ï‡ÑƒÕ¹",
    "à¸„à¹’Ï‚à¹”Ñ”Å¦ï»®Ñ’à¹€×ŸÐºÉ­à¹“à¸ à¹×§á»£Ð³à¸£Õ‡à¸¢×©à¸¬××¥Õ¹à¸„à¹’Ï‚à¹”Ñ”Å¦ï»®Ñ’à¹€×ŸÐºÉ­à¹“à¸ à¹×§á»£Ð³à¸£Õ‡à¸¢×©à¸¬××¥Õ¹",
    "Ð°ÑŠÑâ†ÑfÐ‘Ð‚Ñ–Ñ˜ÐºlÐ¼Ð¸Ð¾Ñ€qÑ“Ñ•Ñ‚Ñ†vÑˆÑ…ÐŽzÐ”Ð‘Ò€â†Ð„FÐ‘ÐÐ†ÐˆÐŒLÐœÐ˜Ð¤Ð QÐ¯Ð…Ð“Ð¦VÐ©Ð–Ð§Z",
    "áˆáŒŒáˆ­á‹•á‰¿á‰»áŠ—á‹˜áŒŽáŒ‹áŒ•áˆ¨áŒ áŠ­á‹á‹¨á‹’á‹ªáŠá•áˆáˆ€áˆ áˆ¸áˆƒáŒŠáˆáŒŒáˆ­á‹•á‰¿á‰»áŠ—á‹˜áŒŽáŒ‹áŒ•áˆ¨áŒ áŠ­á‹á‹¨á‹’á‹ªáŠá•áˆáˆ€áˆ áˆ¸áˆƒáŒŠ",
    "ð”žð”Ÿð” ð”¡ð”¢ð”£ð”¤ð”¥ð”¦ð”§ð”¨ð”©ð”ªð”«ð”¬ð”­ð”®ð”¯ð”°ð”±ð”²ð”³ð”´ð”µð”¶ð”·ð”„ð”…â„­ð”‡ð”ˆð”‰ð”Šâ„Œâ„‘ð”ð”Žð”ð”ð”‘ð”’ð”“ð””â„œð”–ð”—ð”˜ð”™ð”šð”›ð”œâ„¨",
    "Ã¤á¸…Ä‹á¸‹Ã«á¸ŸÄ¡á¸§Ã¯já¸³á¸·á¹á¹…Ã¶á¹—qá¹›á¹¡áº—Ã¼á¹¿áº…áºÃ¿Å¼Ã„á¸„ÄŠá¸ŠÐá¸žÄ á¸¦Ð‡Já¸²á¸¶á¹€á¹„Ã–á¹–Qá¹šá¹ á¹ªÃœá¹¾áº„áºŒÅ¸Å»",
    "á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´©qÊ€êœ±á´›á´œá´ á´¡xyá´¢á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´©QÊ€êœ±á´›á´œá´ á´¡xYá´¢",
    "ÈºÆ€È¼Ä‘É‡fÇ¥Ä§É¨É‰êÅ‚mnÃ¸áµ½ê—ÉsÅ§áµ¾vwxÉÆ¶ÈºÉƒÈ»ÄÉ†FÇ¤Ä¦Æ—Éˆê€ÅMNÃ˜â±£ê–ÉŒSÅ¦áµ¾VWXÉŽÆµ",
    "â‚bcdâ‚‘fgâ‚•áµ¢â±¼â‚–â‚—â‚˜â‚™â‚’â‚šqáµ£â‚›â‚œáµ¤áµ¥wâ‚“yzâ‚BCDâ‚‘FGâ‚•áµ¢â±¼â‚–â‚—â‚˜â‚™â‚’â‚šQáµ£â‚›â‚œáµ¤áµ¥Wâ‚“YZ",
    "áµƒáµ‡á¶œáµˆáµ‰á¶ áµÊ°â±Ê²áµË¡áµâ¿áµ’áµ–qÊ³Ë¢áµ—áµ˜áµ›Ê·Ë£Ê¸á¶»á´¬á´®á¶œá´°á´±á¶ á´³á´´á´µá´¶á´·á´¸á´¹á´ºá´¼á´¾Qá´¿Ë¢áµ€áµâ±½áµ‚Ë£Ê¸á¶»",
    "ÉqÉ”pÇÉŸÆƒÉ¥Ä±É¾Êž×ŸÉ¯uodbÉ¹sÊ‡nÊŒÊxÊŽzê“¯ê“­â†ƒê“·ÆŽâ„²â…É¥Ä±á’‹ê“˜â…‚WuOê“’Ã’ê“¤Sê“•ê“µðŒ¡MXâ…„Z",
    "Adâ†„bÉ˜êŸ»gHijklmá´Žoqpá´™ê™…TUvwxYzAdâ†ƒbÆŽêŸ»GHIJKâ…ƒMá´ŽOêŸ¼pá´™ê™„TUVWXYZ",
];

/// Detects which transformation was applied to the string, returns the detransformed string and a
/// function to apply the detected transformation to any string
pub fn detect(
	template: &str,
) -> Option<(String, std::sync::Arc<dyn Fn(&mut String) + Send + Sync>)> {
	for &funky_alphabet in FUNKY_ALPHABETS {
		if let Some(untransformed) = template
			.chars()
			.map(|c| {
				funky_alphabet
					.chars()
					.position(|x| x == c)
					.map(|i| NORMAL_ALPHABET.as_bytes()[i] as char)
			})
			.collect::<Option<String>>()
		{
			let transformer = std::sync::Arc::new(move |s: &mut String| {
				*s = s
					.chars()
					.map(|c| match NORMAL_ALPHABET.find(c) {
						// unwrap_or case shouldn't happen (all alphabets are same length)
						Some(i) => funky_alphabet.chars().nth(i).unwrap_or(' '),
						None => c,
					})
					.collect()
			});

			return Some((untransformed, transformer));
		}
	}

	None
}
/*
// Using generic C instead of poise::Command to keep this module pure and innocent from outside
// types
pub fn char_transformer<C>(
	s: &str,
	find_command: impl Fn(&str) -> Option<C>,
) -> Option<(C, CharTransformer)> {
	let reversed = s.chars().rev().collect::<String>();
	if let Some(command) = find_command(&reversed) {
		let transformer = |s: &mut String| *s = s.chars().rev().collect::<String>();
		return Some((command, CharTransformer(Box::new(transformer))));
	}

	for &funky_alphabet in FUNKY_ALPHABETS {
		if let Some(untransformed) = s
			.chars()
			.map(|c| {
				funky_alphabet
					.chars()
					.position(|x| x == c)
					.map(|i| NORMAL_ALPHABET.as_bytes()[i] as char)
			})
			.collect::<Option<String>>()
		{
			if let Some(command) = find_command(&untransformed) {
				let casing_transformer = super::casing_transformer(&untransformed);
				let transformer = move |s: &mut String| {
					if let Some(f) = casing_transformer {
						f(s);
					}
					*s = s
						.chars()
						.map(|c| match NORMAL_ALPHABET.find(c) {
							// unwrap_or case shouldn't happen (all alphabets are same length)
							Some(i) => funky_alphabet.chars().nth(i).unwrap_or(' '),
							None => c,
						})
						.collect()
				};
				return Some((command, CharTransformer(Box::new(transformer))));
			}
			break;
		}
	}

	None
}
 */
